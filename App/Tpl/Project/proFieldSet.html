<include file="Public:header" />
<include file="Public:sidenav" />

<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        Dashboard
        <small>Version 2.0</small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Dashboard</li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content">

      <div class="col-md-15">
        <!-- Horizontal Form -->
        <div class="box box-info">
          <div class="box-header with-border">
            <h3 class="box-title">设置项目报表字段</h3>
          </div><!-- /.box-header -->
          
          <!-- form start -->
          <form action="__URL__/proFieldSet" method="post" class="form-horizontal">
            <div class="box-body">
              <input type="hidden" name="proid" value="{$proid}">
              <div class="form-group">
                <label for="type" class="col-lg-1 control-label">字段类型：</label>
                <div class="col-lg-2">
                  <select name="type" id="columnType" class="form-control">
                    <option value="1">手动</option>
                    <option value="2">公式</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label for="proColumn" class="col-lg-1 control-label" >字段名：</label>
                <div class="col-lg-2">
                  <input type="text" name="proColumn" class="form-control" placeholder="英文名">
                </div>
                <label for="proTitle" class="col-lg-1 control-label" >字段标题：</label>
                <div class="col-lg-2">
                  <input type="text" name="proTitle" class="form-control" placeholder="中文标题">
                </div>
              </div>
              <div class="form-group" id="formuladiv" style="display:none;">
                <label for="formula" class="col-lg-1 control-label" >公式：</label>
                <div class="col-lg-2">
                  <input type="text" name="formula" class="form-control" >
                </div>
              </div>
              <div class="form-group">
                <div class="col-lg-1">
                  <button type="submit" class="btn btn-success pull-right">添加</button>
                </div>
              </div>

            </div><!-- /.box-body -->
          </form>

        </div><!-- /. box box-info-->

        <div class="box box-info">
          <div class="box-header with-border">
            <h3 class="box-title">项目报表字段预览</h3>
            <button id="pfeBtn" onclick="showProFieldEdit()" class="btn btn-success pull-right">修改</button>
          </div><!-- /.box-header -->
          <div class="box-body">
            <volist name="ret" id="vo">
              <div style="display: inline-block;width: 400px;">
                {$vo.ctitle}
                <notempty name="vo.formula">
                  [{$vo.cname}={$vo.formula}]
                <else/>
                  [{$vo.cname}]
                </notempty>
              </div>
            </volist>
          </div>

          <div id="pfeForm" style="display:none">
            <!-- form start -->
            <form action="__URL__/proFieldEdit" method="post" class="form-horizontal">
              <div class="box-body">
                <input type="hidden" name="proid" value="{$proid}">
                <div class="form-group">
                  <label for="type" class="col-lg-1 control-label">字段类型：</label>
                  <div class="col-lg-2">
                    <select name="type" id="columnTypeEdit" class="form-control">
                      <option value="1">手动</option>
                      <option value="2">公式</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label for="proColumn" class="col-lg-1 control-label" >原字段名：</label>
                  <div class="col-lg-2">
                    <input type="text" name="oldProColumn" class="form-control" placeholder="英文名">
                  </div>
                  <label for="proColumn" class="col-lg-1 control-label" >新字段名：</label>
                  <div class="col-lg-2">
                    <input type="text" name="newProColumn" class="form-control" placeholder="英文名">
                  </div>
                </div>
                <div class="form-group">
                  <label for="proTitle" class="col-lg-1 control-label" >原标题：</label>
                  <div class="col-lg-2">
                    <input type="text" name="oldProTitle" class="form-control" placeholder="中文标题">
                  </div>
                  <label for="proTitle" class="col-lg-1 control-label" >新标题：</label>
                  <div class="col-lg-2">
                    <input type="text" name="newProTitle" class="form-control" placeholder="中文标题">
                  </div>
                </div>
                <div class="form-group" id="formulaEdit" style="display:none;">
                  <label for="formula" class="col-lg-1 control-label" >原公式：</label>
                  <div class="col-lg-2">
                    <input type="text" name="oldFormula" class="form-control" >
                  </div>
                  <label for="formula" class="col-lg-1 control-label" >新公式：</label>
                  <div class="col-lg-2">
                    <input type="text" name="newFormula" class="form-control" >
                  </div>
                </div>
                <div class="form-group">
                  <div class="col-lg-1">
                    <button type="submit" class="btn btn-success pull-right">保存</button>
                  </div>
                </div>

              </div><!-- /.box-body -->
            </form>
          </div>

        </div>
    </div><!-- /. col-md-15 -->

    </section>
</div><!-- /.content-wrapper -->

<include file="Public:footer" />
<script type="text/javascript">
$('#columnType').change(function(e) {
    var value = this.value;
    if (value == 2) {
        $('#formuladiv').show();
    } else {
        $('#formuladiv').hide();
    }
});

function showProFieldEdit(){
  $('#pfeForm').toggle();
}

$('#columnTypeEdit').change(function(e) {
    var value = this.value;
    if (value == 2) {
        $('#formulaEdit').show();
    } else {
        $('#formulaEdit').hide();
    }
});
</script>